<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Goober Tutorials</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    font-family: sans-serif;
    line-height: 1.5;
    height: 100%;
  }

  #menu, .tutorial {
    padding: 20px;
  }

  button {
    padding: 8px 16px;
    margin: 5px;
    font-size: 14px;
    cursor: pointer;
  }

  #scroll-container {
    height: 100%;
    overflow-y: scroll;
    scrollbar-width: none;
  }

  #scroll-container::-webkit-scrollbar { width: 0; }

  input { padding: 5px; font-size: 14px; margin-bottom: 5px; }

  .line-item {
    display: flex;
    justify-content: space-between;
    margin-bottom: 3px;
  }

  .line-item button {
    padding: 0 5px;
    font-size: 12px;
  }

  .tutorial-button-wrapper {
    display: flex;
    align-items: center;
    margin-bottom: 5px;
  }

  .tutorial-button-wrapper button {
    margin-right: 5px;
  }

</style>
</head>
<body>

<!-- Menu -->
<div id="menu">
  <h1>Welcome to Goober Tutorials</h1>
  <div id="main-tutorial-wrapper" class="tutorial-button-wrapper">
    <button id="edit-goober-btn">Goober Tutorial</button>
  </div>
  <div id="custom-list"></div>
  <button id="create-btn">Create Custom</button>
</div>

<!-- Scrollable Tutorials -->
<div id="scroll-container" style="display:none;">

  <!-- Main Goober Tutorial -->
  <div class="tutorial" id="main-tutorial" style="display:none;">
    <h2>Main Goober Tutorial</h2>
    <div id="main-steps"></div>
  </div>

  <!-- Custom Tutorial -->
  <div class="tutorial" id="custom-tutorial" style="display:none;">
    <h2 id="custom-tutorial-title"></h2>
    <div id="custom-steps"></div>
  </div>

  <!-- Create/Edit Tutorial -->
  <div class="tutorial" id="create-tutorial" style="display:none;">
    <h2>Create/Edit Tutorial</h2>
    <input type="text" id="custom-title" placeholder="Tutorial Title" />
    <br>
    <input type="text" id="custom-line" placeholder="Line text" />
    <button id="add-line">Add Line</button>
    <p>Lines (will become steps when viewed):</p>
    <div id="preview-lines"></div>
    <button id="finish-custom">Save Tutorial</button>
  </div>

</div>

<script>
// ===== Storage =====
let tutorials = JSON.parse(localStorage.getItem("tutorials") || "{}");

// ===== Menu Buttons =====
const menu = document.getElementById("menu");
const scrollContainer = document.getElementById("scroll-container");
const createBtn = document.getElementById("create-btn");
const customListDiv = document.getElementById("custom-list");
const editGooberBtn = document.getElementById("edit-goober-btn");

const mainTutorial = document.getElementById("main-tutorial");
const mainContainer = document.getElementById("main-steps");
let step = 1;

// ===== Default Main Goober Tutorial Lines =====
if (!tutorials["Goober Tutorial"]) {
  tutorials["Goober Tutorial"] = [
    "be a goober",
    "goober around",
    "just goob",
    "try goobin",
    "if it doesn't work, goob again",
    "goober",
    "uh, is that it, WAIT NO i forgot theres more",
    "goummberbrrrrrrrrrtrr",
    "goobrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrr"
  ];
  localStorage.setItem("tutorials", JSON.stringify(tutorials));
}

// ===== Render Custom Buttons =====
function refreshCustomMenu() {
  customListDiv.innerHTML = "";
  for (const key in tutorials) {
    if (key === "Goober Tutorial") continue;
    const wrapper = document.createElement("div");
    wrapper.className = "tutorial-button-wrapper";

    const btn = document.createElement("button");
    btn.textContent = key;
    btn.addEventListener("click", () => openTutorial(key));
    btn.addEventListener("contextmenu", e => {
      e.preventDefault();
      editTutorial(key);
    });
    wrapper.appendChild(btn);

    const deleteBtn = document.createElement("button");
    deleteBtn.textContent = "✖";
    deleteBtn.addEventListener("click", () => {
      if (confirm(`Delete tutorial "${key}"?`)) {
        delete tutorials[key];
        localStorage.setItem("tutorials", JSON.stringify(tutorials));
        refreshCustomMenu();
      }
    });
    wrapper.appendChild(deleteBtn);
    customListDiv.appendChild(wrapper);
  }
}
refreshCustomMenu();

// ===== Open Tutorial =====
const customTutorialDiv = document.getElementById("custom-tutorial");
const customContainer = document.getElementById("custom-steps");
const customTitleDisplay = document.getElementById("custom-tutorial-title");
let currentTutorial = null;
let customStepNumber = 1;

function openTutorial(title) {
  currentTutorial = title;
  menu.style.display = "none";
  scrollContainer.style.display = "block";
  mainTutorial.style.display = "none";
  customTutorialDiv.style.display = "block";
  document.getElementById("create-tutorial").style.display = "none";
  customContainer.innerHTML = "";
  customStepNumber = 1;

  const lines = tutorials[title];
  for (let i = 0; i < 40; i++) {
    const div = document.createElement("div");
    div.textContent = `Step ${i+1}: ${lines[Math.floor(Math.random()*lines.length)]}`;
    customContainer.appendChild(div);
  }
  customStepNumber = 41;
  customTitleDisplay.textContent = title;
}

// ===== Edit Tutorial (includes main Goober tutorial) =====
const createDiv = document.getElementById("create-tutorial");
const customTitleInput = document.getElementById("custom-title");
const customLineInput = document.getElementById("custom-line");
const addLineBtn = document.getElementById("add-line");
const finishBtn = document.getElementById("finish-custom");
const previewLines = document.getElementById("preview-lines");
let editingLines = [];
let editingTitle = "";

function editTutorial(title) {
  editingTitle = title;
  editingLines = [...tutorials[title]];
  renderPreview();
  customTitleInput.value = title;
  menu.style.display = "none";
  scrollContainer.style.display = "block";
  createDiv.style.display = "block";
  mainTutorial.style.display = "none";
  customTutorialDiv.style.display = "none";
}

// Add line
addLineBtn.addEventListener("click", () => {
  const text = customLineInput.value.trim();
  if (!text) return;
  editingLines.push(text);
  customLineInput.value = "";
  renderPreview();
});

// Render preview lines with remove
function renderPreview() {
  previewLines.innerHTML = "";
  editingLines.forEach((line, idx) => {
    const div = document.createElement("div");
    div.className = "line-item";
    div.innerHTML = `<span>${line}</span>`;
    const removeBtn = document.createElement("button");
    removeBtn.textContent = "✖";
    removeBtn.addEventListener("click", () => {
      editingLines.splice(idx,1);
      renderPreview();
    });
    div.appendChild(removeBtn);
    previewLines.appendChild(div);
  });
}

// Finish editing/creating
finishBtn.addEventListener("click", () => {
  const title = customTitleInput.value.trim() || "Untitled Tutorial";
  if (editingLines.length === 0) return;
  tutorials[title] = editingLines;
  localStorage.setItem("tutorials", JSON.stringify(tutorials));
  refreshCustomMenu();
  openTutorial(title);
});

// ===== Menu buttons =====
createBtn.addEventListener("click", () => {
  editingLines = [];
  editingTitle = "";
  customTitleInput.value = "";
  customLineInput.value = "";
  renderPreview();
  menu.style.display = "none";
  scrollContainer.style.display = "block";
  createDiv.style.display = "block";
  mainTutorial.style.display = "none";
  customTutorialDiv.style.display = "none";
});

editGooberBtn.addEventListener("click", () => editTutorial("Goober Tutorial"));

// ===== Infinite Scroll =====
scrollContainer.addEventListener("scroll", () => {
  if (scrollContainer.scrollTop + scrollContainer.clientHeight >= scrollContainer.scrollHeight - 50) {
    if (customTutorialDiv.style.display==="block" && currentTutorial) {
      const lines = tutorials[currentTutorial];
      for (let i=0;i<10;i++){
        const div = document.createElement("div");
        div.textContent = `Step ${customStepNumber}: ${lines[Math.floor(Math.random()*lines.length)]}`;
        customContainer.appendChild(div);
        customStepNumber++;
      }
    }
  }
});
</script>

</body>
</html>
