<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Goober Tutorials</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    font-family: sans-serif;
    line-height: 1.5;
    height: 100%;
  }

  #menu, .tutorial {
    padding: 20px;
  }

  button {
    padding: 10px 20px;
    margin: 5px;
    font-size: 16px;
    cursor: pointer;
  }

  #scroll-container {
    height: 100%;
    overflow-y: scroll;
    scrollbar-width: none; 
  }

  #scroll-container::-webkit-scrollbar {
    width: 0;
  }

  input {
    padding: 5px;
    font-size: 14px;
    margin-bottom: 5px;
  }

  .line-item {
    display: flex;
    justify-content: space-between;
    margin-bottom: 3px;
  }

  .line-item button {
    padding: 0 5px;
    font-size: 12px;
  }
</style>
</head>
<body>

<!-- Menu -->
<div id="menu">
  <h1>Welcome to Goober Tutorials</h1>
  <button id="goober-btn">Goober Tutorial</button>
  <div id="custom-list"></div>
  <button id="create-btn">Create Custom</button>
</div>

<!-- Scrollable Tutorials -->
<div id="scroll-container" style="display:none;">

  <!-- Main Goober Tutorial -->
  <div class="tutorial" id="main-tutorial" style="display:none;">
    <h2>Main Goober Tutorial</h2>
    <div id="main-steps"></div>
  </div>

  <!-- Custom Tutorial -->
  <div class="tutorial" id="custom-tutorial" style="display:none;">
    <h2 id="custom-tutorial-title"></h2>
    <div id="custom-steps"></div>
  </div>

  <!-- Create/Edit Custom Tutorial -->
  <div class="tutorial" id="create-tutorial" style="display:none;">
    <h2>Create/Edit Tutorial</h2>
    <input type="text" id="custom-title" placeholder="Tutorial Title" />
    <br>
    <input type="text" id="custom-line" placeholder="Line text" />
    <button id="add-line">Add Line</button>
    <p>Lines (will become steps when viewed):</p>
    <div id="preview-lines"></div>
    <button id="finish-custom">Save Tutorial</button>
  </div>

</div>

<script>
// ===== Menu Handling =====
const menu = document.getElementById("menu");
const scrollContainer = document.getElementById("scroll-container");
const gooberBtn = document.getElementById("goober-btn");
const createBtn = document.getElementById("create-btn");
const customListDiv = document.getElementById("custom-list");

// ===== Main Goober Tutorial =====
let step = 1;
const mainContainer = document.getElementById("main-steps");
const messages = [
  "be a goober",
  "goober around",
  "just goob",
  "try goobin",
  "if it doesn't work, goob again",
  "goober",
  "uh, is that it, WAIT NO i forgot theres more",
  "goummberbrrrrrrrrrtrr",
  "goobrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrr"
];

function randomMessage() {
  return messages[Math.floor(Math.random() * messages.length)];
}

function addMainStep() {
  const div = document.createElement("div");
  div.textContent = `Step ${step}: ${randomMessage()}`;
  mainContainer.appendChild(div);
  step++;
}

for (let i = 0; i < 40; i++) addMainStep();

// ===== Custom Tutorials Storage =====
let customTutorials = JSON.parse(localStorage.getItem("customTutorials") || "{}");
let currentCustom = null; // currently viewing tutorial
let customStepNumber = 1;

// ===== Update Menu Buttons for Custom Tutorials =====
function refreshCustomMenu() {
  customListDiv.innerHTML = "";
  for (const key in customTutorials) {
    const btn = document.createElement("button");
    btn.textContent = key;
    btn.addEventListener("click", () => openCustomTutorial(key));
    btn.addEventListener("contextmenu", e => {
      e.preventDefault();
      editCustomTutorial(key);
    });
    customListDiv.appendChild(btn);
  }
}
refreshCustomMenu();

// ===== Open Custom Tutorial =====
const customTitleDisplay = document.getElementById("custom-tutorial-title");
const customContainer = document.getElementById("custom-steps");

function openCustomTutorial(title) {
  menu.style.display = "none";
  scrollContainer.style.display = "block";
  document.getElementById("main-tutorial").style.display = "none";
  document.getElementById("create-tutorial").style.display = "none";
  document.getElementById("custom-tutorial").style.display = "block";
  currentCustom = title;
  customContainer.innerHTML = "";
  customStepNumber = 1;

  const lines = customTutorials[title];
  // Fill initial 40 steps randomly from lines
  for (let i = 0; i < 40; i++) {
    const div = document.createElement("div");
    const line = lines[Math.floor(Math.random() * lines.length)];
    div.textContent = `Step ${i + 1}: ${line}`;
    customContainer.appendChild(div);
  }
  customStepNumber = 41;
  customTitleDisplay.textContent = title;
}

// ===== Edit/Create Custom Tutorial =====
const createTutorialDiv = document.getElementById("create-tutorial");
const customTitleInput = document.getElementById("custom-title");
const customLineInput = document.getElementById("custom-line");
const addLineBtn = document.getElementById("add-line");
const finishCustomBtn = document.getElementById("finish-custom");
const previewLines = document.getElementById("preview-lines");

let editingLines = [];

// Add a line to preview
addLineBtn.addEventListener("click", () => {
  const text = customLineInput.value.trim();
  if (!text) return;
  editingLines.push(text);
  customLineInput.value = "";
  renderPreviewLines();
});

// Render preview lines with remove button
function renderPreviewLines() {
  previewLines.innerHTML = "";
  editingLines.forEach((line, index) => {
    const div = document.createElement("div");
    div.className = "line-item";
    div.innerHTML = `<span>${line}</span>`;
    const removeBtn = document.createElement("button");
    removeBtn.textContent = "âœ–";
    removeBtn.addEventListener("click", () => {
      editingLines.splice(index, 1);
      renderPreviewLines();
    });
    div.appendChild(removeBtn);
    previewLines.appendChild(div);
  });
}

// Finish and save tutorial
finishCustomBtn.addEventListener("click", () => {
  const title = customTitleInput.value.trim() || "Untitled Tutorial";
  if (editingLines.length === 0) return;
  customTutorials[title] = editingLines;
  localStorage.setItem("customTutorials", JSON.stringify(customTutorials));
  refreshCustomMenu();
  openCustomTutorial(title);
});

// ===== Menu Buttons =====
gooberBtn.addEventListener("click", () => {
  menu.style.display = "none";
  scrollContainer.style.display = "block";
  document.getElementById("main-tutorial").style.display = "block";
  document.getElementById("custom-tutorial").style.display = "none";
  document.getElementById("create-tutorial").style.display = "none";
});

// Create new custom tutorial
createBtn.addEventListener("click", () => {
  menu.style.display = "none";
  scrollContainer.style.display = "block";
  createTutorialDiv.style.display = "block";
  document.getElementById("main-tutorial").style.display = "none";
  document.getElementById("custom-tutorial").style.display = "none";
  customTitleInput.value = "";
  customLineInput.value = "";
  editingLines = [];
  renderPreviewLines();
});

// Edit existing tutorial
function editCustomTutorial(title) {
  menu.style.display = "none";
  scrollContainer.style.display = "block";
  createTutorialDiv.style.display = "block";
  document.getElementById("main-tutorial").style.display = "none";
  document.getElementById("custom-tutorial").style.display = "none";
  customTitleInput.value = title;
  editingLines = [...customTutorials[title]];
  renderPreviewLines();
}

// ===== Infinite Scrolling =====
scrollContainer.addEventListener("scroll", () => {
  if (scrollContainer.scrollTop + scrollContainer.clientHeight >= scrollContainer.scrollHeight - 50) {
    // Main tutorial
    if (document.getElementById("main-tutorial").style.display === "block") {
      for (let i = 0; i < 10; i++) addMainStep();
    }

    // Custom tutorial
    if (document.getElementById("custom-tutorial").style.display === "block" && currentCustom) {
      const lines = customTutorials[currentCustom];
      for (let i = 0; i < 10; i++) {
        const div = document.createElement("div");
        const line = lines[Math.floor(Math.random() * lines.length)];
        div.textContent = `Step ${customStepNumber}: ${line}`;
        customContainer.appendChild(div);
        customStepNumber++;
      }
    }
  }
});
</script>

</body>
</html>
