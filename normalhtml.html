<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Global Goober Likes</title>
<style>
  body { font-family: sans-serif; padding: 40px; }
  #likeBtn { background: yellow; padding: 10px; cursor: pointer; font-size: 18px; }
</style>
</head>
<body>
  <h1>How To Be a Goober</h1>

  <div id="likeBtn">
    ❤️ Like: <span id="likeCount">0</span>
  </div>

<script>
  const likeCountEl = document.getElementById("likeCount");
  const likeBtn = document.getElementById("likeBtn");

  const repoUser = "YOUR_USERNAME";
  const repoName = "YOUR_REPO";
  const filePath = "likes.json";

  let hasLiked = localStorage.getItem("gooberLiked");

  // Fetch & update count
  async function refreshCount() {
    const url = `https://raw.githubusercontent.com/${repoUser}/${repoName}/main/${filePath}`;
    const res = await fetch(url);
    const data = await res.json();
    likeCountEl.textContent = data.count;

    if (hasLiked) {
      likeBtn.style.opacity = "0.6";
      likeBtn.style.pointerEvents = "none";
    }
  }

  setInterval(refreshCount, 3000);
  refreshCount();

  likeBtn.addEventListener("click", async () => {
    if (hasLiked) return;

    await fetch("/.netlify/functions/updateLikes", { method: "POST" });

    localStorage.setItem("gooberLiked", "true");
    hasLiked = true;
    refreshCount();
  });
</script>
</body>
</html>
