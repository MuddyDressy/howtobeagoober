<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Goober Tutorials</title>
<style>
body { font-family: sans-serif; margin:0; padding:0; }
button { margin:4px; padding:6px 12px; cursor:pointer; font-size:14px; }
#menu, #editor, #viewer { padding:20px; }
#scroll-container {
  height:100vh;
  overflow-y:scroll;
  padding:20px;
  scrollbar-width:none;
}
#scroll-container::-webkit-scrollbar { width:0; }
h1, h2 { text-align:left; margin:20px 0; }
div.step { margin-bottom:5px; }
.version { font-size:14px; color:gray; margin-top:10px; }
.tutorial-btn { position:relative; display:inline-block; margin:4px; }
.delete-btn { color:white; background:red; border:none; padding:2px 5px; cursor:pointer; font-weight:bold; margin-left:4px; }
</style>
</head>
<body>

<!-- ===== Menu ===== -->
<div id="menu">
<h1>Goober Tutorials</h1>
<div id="tutorial-buttons"></div>
<button id="create-btn">Create Custom</button>
<button id="reset-btn">Reset All</button>
<div class="version">v40</div>
</div>

<!-- ===== Editor ===== -->
<div id="editor" style="display:none;">
<h2>Create/Edit Tutorial</h2>
<input type="text" id="title-input" placeholder="Tutorial Title"><br>
<input type="text" id="line-input" placeholder="Line text">
<button id="add-line">Add Line</button>
<div id="lines-preview"></div>
<button id="save-tutorial">Save Tutorial</button>
<button id="back-menu">Back to Menu</button>
<div class="version">v40</div>
</div>

<!-- ===== Viewer ===== -->
<div id="viewer" style="display:none;">
<div id="scroll-container">
<!-- title and steps inserted dynamically -->
</div>
<div class="version">v40</div>
</div>

<script>
// ===== Storage =====
let tutorials = JSON.parse(localStorage.getItem("tutorials") || "{}");
const defaultGoober = [
"be a goober","goober around","just goob","try goobin",
"if it doesn't work, goob again","goober",
"uh, is that it, WAIT NO i forgot theres more",
"goummberbrrrrrrrrrtrr","goobrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrr"
];
if(!tutorials["Goober Tutorial"]) {
  tutorials["Goober Tutorial"] = [...defaultGoober];
  localStorage.setItem("tutorials", JSON.stringify(tutorials));
}

// ===== Elements =====
const menu = document.getElementById("menu");
const tutorialButtonsDiv = document.getElementById("tutorial-buttons");
const editor = document.getElementById("editor");
const viewer = document.getElementById("viewer");
const linesPreview = document.getElementById("lines-preview");
const titleInput = document.getElementById("title-input");
const lineInput = document.getElementById("line-input");
const scrollContainer = document.getElementById("scroll-container");

let editingLines = [];
let editingTitle = "";
let currentTutorial = "";
let stepNumber = 1;

// ===== Menu =====
function refreshMenu(){
  tutorialButtonsDiv.innerHTML = "";
  for(const key in tutorials){
    const wrapper = document.createElement("div");
    wrapper.className="tutorial-btn";
    const btn = document.createElement("button");
    btn.textContent = key;
    btn.addEventListener("click",()=>openTutorial(key));
    btn.addEventListener("contextmenu",(e)=>{ 
      e.preventDefault(); 
      openEditor(key); 
    });
    const del = document.createElement("button");
    del.textContent="âœ–";
    del.className="delete-btn";
    del.addEventListener("click",(e)=>{
      e.stopPropagation();
      if(confirm(`Delete tutorial "${key}"?`)){
        delete tutorials[key];
        localStorage.setItem("tutorials",JSON.stringify(tutorials));
        refreshMenu();
      }
    });
    wrapper.appendChild(btn);
    wrapper.appendChild(del);
    tutorialButtonsDiv.appendChild(wrapper);
  }
}
refreshMenu();

// ===== Editor Functions =====
function openEditor(title){
  editor.style.display="block";
  viewer.style.display="none";
  menu.style.display="none";
  editingTitle = title;
  editingLines = [...tutorials[title]];
  titleInput.value = title;
  renderLinesPreview();
}

function renderLinesPreview(){
  linesPreview.innerHTML="";
  editingLines.forEach(line=>{
    const div = document.createElement("div");
    div.textContent=line;
    linesPreview.appendChild(div);
  });
}

document.getElementById("add-line").addEventListener("click",()=>{
  const text = lineInput.value.trim();
  if(!text) return;
  editingLines.push(text);
  lineInput.value="";
  renderLinesPreview();
});

document.getElementById("save-tutorial").addEventListener("click",()=>{
  const title = titleInput.value.trim()||"Untitled";
  if(editingLines.length===0) return alert("Must have at least 1 line!");
  tutorials[title] = [...editingLines];
  localStorage.setItem("tutorials",JSON.stringify(tutorials));
  openTutorial(title);
});

// ===== Viewer Functions =====
function openTutorial(title){
  viewer.style.display="block";
  editor.style.display="none";
  menu.style.display="none";
  scrollContainer.innerHTML = "";

  // Insert title at top
  const titleElement = document.createElement("h1");
  titleElement.textContent = title;
  scrollContainer.appendChild(titleElement);

  currentTutorial = title;
  stepNumber = 1;
  const lines = tutorials[title];

  // Add initial 50 steps
  for(let i=0;i<50;i++){
    const div = document.createElement("div");
    div.className="step";
    div.textContent = `Step ${stepNumber}: ${lines[Math.floor(Math.random()*lines.length)]}`;
    scrollContainer.appendChild(div);
    stepNumber++;
  }
}

// Infinite scrolling
scrollContainer.addEventListener("scroll",()=>{
  if(scrollContainer.scrollTop + scrollContainer.clientHeight >= scrollContainer.scrollHeight-50){
    if(currentTutorial){
      const lines = tutorials[currentTutorial];
      for(let i=0;i<10;i++){
        const div=document.createElement("div");
        div.className="step";
        div.textContent=`Step ${stepNumber}: ${lines[Math.floor(Math.random()*lines.length)]}`;
        scrollContainer.appendChild(div);
        stepNumber++;
      }
    }
  }
});

// ===== Menu Buttons =====
document.getElementById("create-btn").addEventListener("click", ()=>{
  editingLines=[];
  titleInput.value="";
  lineInput.value="";
  editor.style.display="block";
  viewer.style.display="none";
  menu.style.display="none";
  renderLinesPreview();
});

document.getElementById("reset-btn").addEventListener("click",()=>{
  if(confirm("Reset all tutorials to default?")){
    tutorials={"Goober Tutorial":[...defaultGoober]};
    localStorage.setItem("tutorials",JSON.stringify(tutorials));
    refreshMenu();
    menu.style.display="block";
    editor.style.display="none";
    viewer.style.display="none";
  }
});

document.getElementById("back-menu").addEventListener("click",()=>{
  editor.style.display="none";
  menu.style.display="block";
});
</script>

</body>
</html>
