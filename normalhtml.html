<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Goober Tutorials v34</title>
<style>
body { font-family:sans-serif; margin:0; padding:0; }
#menu, #editor, #viewer { padding:20px; }
button { margin:4px; cursor:pointer; padding:8px 16px; font-size:14px; }
.line-item { display:flex; justify-content:space-between; margin-bottom:5px; }
.line-item button { padding:2px 6px; font-size:14px; }
#scroll-container {
  height: calc(100vh - 80px); /* almost full screen */
  overflow-y: scroll;
  padding:10px;
}
#viewer-title, #menu h1 {
  font-size:48px; /* consistent with menu */
  text-align:left; /* left-aligned now */
  margin:20px 0;
}
</style>
</head>
<body>

<!-- ===== Menu ===== -->
<div id="menu">
<h1>Goober Tutorials</h1>
<h2>Version: v34</h2>
<div>
<button id="goober-btn">Goober Tutorial</button>
</div>
<div id="custom-list"></div>
<button id="create-btn">Create Custom</button>
<button id="reset-btn">Reset All</button>
</div>

<!-- ===== Editor ===== -->
<div id="editor" style="display:none;">
<h2>Edit/Create Tutorial</h2>
<input type="text" id="title-input" placeholder="Tutorial Title"><br>
<input type="text" id="line-input" placeholder="Line text">
<button id="add-line">Add Line</button>
<div id="lines-preview"></div>
<button id="save-tutorial">Save Tutorial</button>
<button id="back-menu">Back to Menu</button>
</div>

<!-- ===== Viewer ===== -->
<div id="viewer" style="display:none;">
<h1 id="viewer-title"></h1>
<div id="scroll-container"></div> <!-- infinite steps go here -->
</div>

<script>
// ===== Storage =====
let tutorials = JSON.parse(localStorage.getItem("tutorials") || "{}");
const defaultGoober = [
"be a goober","goober around","just goob","try goobin",
"if it doesn't work, goob again","goober",
"uh, is that it, WAIT NO i forgot theres more",
"goummberbrrrrrrrrrtrr","goobrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrr"
];
if(!tutorials["Goober Tutorial"]) { tutorials["Goober Tutorial"] = [...defaultGoober]; localStorage.setItem("tutorials",JSON.stringify(tutorials)); }

// ===== Elements =====
const menu = document.getElementById("menu");
const editor = document.getElementById("editor");
const viewer = document.getElementById("viewer");
const customList = document.getElementById("custom-list");
const linesPreview = document.getElementById("lines-preview");
const titleInput = document.getElementById("title-input");
const lineInput = document.getElementById("line-input");
const scrollContainer = document.getElementById("scroll-container");
const viewerTitle = document.getElementById("viewer-title");

let editingLines = [];
let editingTitle = "";
let currentTutorial = "";
let stepNumber = 1;

// ===== Menu =====
function refreshMenu(){
  customList.innerHTML = "";
  for(const key in tutorials){
    if(key==="Goober Tutorial") continue;
    const wrapper = document.createElement("div");
    wrapper.style.marginBottom="4px";
    const btn = document.createElement("button");
    btn.textContent = key;
    btn.addEventListener("click",()=>openTutorial(key));
    btn.addEventListener("contextmenu",e=>{e.preventDefault(); openEditor(key)});
    wrapper.appendChild(btn);
    const delBtn = document.createElement("button");
    delBtn.textContent="✖";
    delBtn.addEventListener("click",()=>{
      if(confirm(`Delete "${key}"?`)){
        delete tutorials[key];
        localStorage.setItem("tutorials",JSON.stringify(tutorials));
        refreshMenu();
      }
    });
    wrapper.appendChild(delBtn);
    customList.appendChild(wrapper);
  }
}
refreshMenu();

// ===== Editor Functions =====
function openEditor(title){
  editor.style.display="block";
  viewer.style.display="none";
  menu.style.display="none";
  editingTitle = title;
  editingLines = [...tutorials[title]];
  titleInput.value = title;
  renderLinesPreview();
}

function renderLinesPreview(){
  linesPreview.innerHTML="";
  editingLines.forEach((line)=>{
    const div = document.createElement("div");
    div.className="line-item";
    const span = document.createElement("span");
    span.textContent=line;
    const btn = document.createElement("button");
    btn.textContent="✖";
    // Remove the exact line
    btn.addEventListener("click",()=>{
      editingLines = editingLines.filter(l => l !== line);
      renderLinesPreview();
    });
    div.appendChild(span);
    div.appendChild(btn);
    linesPreview.appendChild(div);
  });
}

document.getElementById("add-line").addEventListener("click",()=>{
  const text = lineInput.value.trim();
  if(!text) return;
  editingLines.push(text);
  lineInput.value="";
  renderLinesPreview();
});

document.getElementById("save-tutorial").addEventListener("click",()=>{
  const title = titleInput.value.trim()||"Untitled";
  if(editingLines.length===0) return alert("Must have at least 1 line!");
  tutorials[title] = [...editingLines];
  localStorage.setItem("tutorials",JSON.stringify(tutorials));
  openTutorial(title);
});

// ===== Viewer Functions =====
function openTutorial(title){
  viewer.style.display="block";
  editor.style.display="none";
  menu.style.display="none";
  scrollContainer.innerHTML="";
  viewerTitle.textContent = title;
  currentTutorial = title;
  stepNumber = 1;
  const lines = tutorials[title];
  for(let i=0;i<50;i++){ // START WITH 50
    const div = document.createElement("div");
    div.textContent=`Step ${i+1}: ${lines[Math.floor(Math.random()*lines.length)]}`;
    scrollContainer.appendChild(div);
  }
  stepNumber=51;
}

// Infinite scrolling
scrollContainer.addEventListener("scroll",()=>{
  if(scrollContainer.scrollTop + scrollContainer.clientHeight >= scrollContainer.scrollHeight-50){
    if(currentTutorial){
      const lines = tutorials[currentTutorial];
      for(let i=0;i<10;i++){
        const div=document.createElement("div");
        div.textContent=`Step ${stepNumber}: ${lines[Math.floor(Math.random()*lines.length)]}`;
        scrollContainer.appendChild(div);
        stepNumber++;
      }
    }
  }
});

// ===== Menu Buttons =====
document.getElementById("create-btn").addEventListener("click", ()=>{
  editingLines=[];
  titleInput.value="";
  lineInput.value="";
  editor.style.display="block";
  viewer.style.display="none";
  menu.style.display="none";
  renderLinesPreview();
});

document.getElementById("goober-btn").addEventListener("click",()=>openTutorial("Goober Tutorial"));
document.getElementById("goober-btn").addEventListener("contextmenu", e=>{e.preventDefault(); openEditor("Goober Tutorial");});

document.getElementById("reset-btn").addEventListener("click",()=>{
  if(confirm("Reset all tutorials to default?")){
    tutorials={"Goober Tutorial":[...defaultGoober]};
    localStorage.setItem("tutorials",JSON.stringify(tutorials));
    refreshMenu();
    menu.style.display="block";
    editor.style.display="none";
    viewer.style.display="none";
  }
});

document.getElementById("back-menu").addEventListener("click",()=>{
  editor.style.display="none";
  menu.style.display="block";
});
</script>

</body>
</html>
